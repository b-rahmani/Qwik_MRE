import{R as I}from"./q-c210a59f.js";import{c as q}from"./q-c210a59f.js";import{p as S}from"./q-70be9b46.js";import"./q-5a631909.js";const G=async(t,o,e)=>{var d,a;const[c]=I();if(c!=null&&c.value&&((a=(d=c==null?void 0:c.value)==null?void 0:d.user)!=null&&a.guid))try{const i=await S("order/additem",{entityGuid:t.guid,entityType:o,quantity:e,userGuid:c==null?void 0:c.value.user.guid});return trigger("cartChanged"),i}catch(i){console.log(i)}else{let i=null;if(i=localStorage.getItem("cart"),i){const l=JSON.parse(i);l.order;const m=l.orderLines,n=m.find(g=>g.entityGuid===t.guid);let u=[];n?u=[...m.map(g=>{if(g.entityGuid==t.guid){const y=g.quantity+1,f=t.relatedItems.price.amount*y;return{entityType:o,entityGuid:t.guid,quantity:y,price:t.relatedItems.price.amount,totalPrice:f,relatedItems:{entity:t}}}else return g})]:u=[...m,{entityType:o,entityGuid:t.guid,quantity:1,price:t.relatedItems.price.amount,totalPrice:t.relatedItems.price.amount,relatedItems:{entity:t}}];let s=0,p=0;u.map(g=>{s+=g.quantity,p+=g.totalPrice});const r={order:{totalPrice:p,relatedItems:{itemsCount:s}},orderLines:u};return localStorage.setItem("cart",JSON.stringify(r)),console.log(JSON.parse(localStorage.getItem("cart"))),trigger("cartChanged"),{cart:JSON.parse(localStorage.getItem("cart"))}}else{const l={order:{totalPrice:t.relatedItems.price.amount,relatedItems:{itemsCount:1}},orderLines:[{entityType:o,entityGuid:t.guid,quantity:1,price:t.relatedItems.price.amount,totalPrice:t.relatedItems.price.amount,relatedItems:{entity:t}}]};return localStorage.setItem("cart",JSON.stringify(l)),trigger("cartChanged"),{cart:JSON.parse(localStorage.getItem("cart"))}}}},P=async(t,o)=>{var c,d;const[e]=I();if(e!=null&&e.value&&((d=(c=e==null?void 0:e.value)==null?void 0:c.user)!=null&&d.guid))try{const a=await S("order/decreasequantity",{entityGuid:t.guid,entityType:o,userGuid:e==null?void 0:e.value.user.guid});return trigger("cartChanged"),a}catch(a){console.log(a)}else{let a=null;if(a=localStorage.getItem("cart"),a){const i=JSON.parse(a);i.order;const l=i.orderLines,m=l.find(r=>r.entityGuid===t.guid);let n=[];m&&(m.quantity==1?n=l.filter(r=>r.entityGuid!=t.guid):n=[...l.map(r=>{if(r.entityGuid==t.guid){const g=r.quantity-1,y=t.relatedItems.price.amount*g;return{entityType:o,entityGuid:t.guid,quantity:g,price:t.relatedItems.price.amount,totalPrice:y,relatedItems:{entity:t}}}else return r})]);let u=0,s=0;n.map(r=>{u+=r.quantity,s+=r.totalPrice});const p={order:{totalPrice:s,relatedItems:{itemsCount:u}},orderLines:n};return localStorage.setItem("cart",JSON.stringify(p)),console.log(JSON.parse(localStorage.getItem("cart"))),trigger("cartChanged"),{cart:JSON.parse(localStorage.getItem("cart"))}}}},N=async()=>{var o,e;const[t]=I();if(t!=null&&t.value&&((e=(o=t==null?void 0:t.value)==null?void 0:o.user)!=null&&e.guid))try{const c=await S("order/removecart",{userGuid:t==null?void 0:t.value.user.guid});return trigger("cartChanged"),c}catch(c){console.log(c)}else if(cart=localStorage.getItem("cart"),cart)return localStorage.removeItem("cart"),trigger("cartChanged"),{cart:JSON.parse(localStorage.getItem("cart"))}},v=async(t,o)=>{var c,d;const[e]=I();if(e!=null&&e.value&&((d=(c=e==null?void 0:e.value)==null?void 0:c.user)!=null&&d.guid))try{const a=await S("order/increasequantity",{entityGuid:t.guid,entityType:o,userGuid:e==null?void 0:e.value.user.guid});return trigger("cartChanged"),a}catch(a){console.log(a)}else{let a=null;if(a=localStorage.getItem("cart"),a){const i=JSON.parse(a);i.order;const l=i.orderLines,m=l.find(r=>r.entityGuid===t.guid);let n=[];m&&(n=[...l.map(r=>{if(r.entityGuid==t.guid){const g=r.quantity+1,y=t.relatedItems.price.amount*g;return{entityType:o,entityGuid:t.guid,quantity:g,price:t.relatedItems.price.amount,totalPrice:y,relatedItems:{entity:t}}}else return r})]);let u=0,s=0;n.map(r=>{u+=r.quantity,s+=r.totalPrice});const p={order:{totalPrice:s,relatedItems:{itemsCount:u}},orderLines:n};return localStorage.setItem("cart",JSON.stringify(p)),console.log(JSON.parse(localStorage.getItem("cart"))),trigger("cartChanged"),{cart:JSON.parse(localStorage.getItem("cart"))}}}},J=async(t,o)=>{var c,d;const[e]=I();if(e!=null&&e.value&&((d=(c=e==null?void 0:e.value)==null?void 0:c.user)!=null&&d.guid))try{const a=await S("order/removeitem",{entityGuid:t.guid,entityType:o,userGuid:e==null?void 0:e.value.user.guid});return trigger("cartChanged"),a}catch(a){console.log(a)}else{let a=null;if(a=localStorage.getItem("cart"),a){const i=JSON.parse(a);i.order;const l=i.orderLines,m=l.find(r=>r.entityGuid===t.guid);let n=[];m&&(n=l.filter(r=>r.entityGuid!=t.guid));let u=0,s=0;n.map(r=>{u+=r.quantity,s+=r.totalPrice});const p={order:{totalQuantity:u,totalPrice:s,relatedItems:{itemsCount:u}},orderLines:n};return localStorage.setItem("cart",JSON.stringify(p)),console.log(JSON.parse(localStorage.getItem("cart"))),trigger("cartChanged"),{cart:JSON.parse(localStorage.getItem("cart"))}}}};export{q as _hW,v as s_H0YAoOrTuMk,P as s_PSO2Tkjhp7E,J as s_Z7QBEMeOSe0,N as s_eb4INc0CyMA,G as s_vHd7BH0ITIY};
